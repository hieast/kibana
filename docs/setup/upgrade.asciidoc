[[upgrade]]
== 升级 Kibana

[IMPORTANT]
===========================================
在升级 Kibana 之前：

* 参考 <<breaking-changes,breaking changes>> 文档。
* 在升级生产服务之前先在测试环境测试升级。
* 使用 Elasticsearch 的
  {es-ref}modules-snapshots.html[snapshots] 特性备份数据。除非有备份数据，否则版本**不能向前回滚**。
* 如果使用了自定义插件，检查其是否有兼容版本。
===========================================

取决于升级前的的 Kibana 版本，升级的过程各不相同。请参考以下表格决定需要按照哪个过程进行升级：

[cols="1<m,1<m,3",options="header",]
|=======================================================================
|升级前   |升级后     |支持的升级类型
|3.x            |5.x            |<<upgrade-new-install,New installation>>
|4.0 or 4.1     |5.x            |<<upgrade-standard-reindex,Standard upgrade & reindex>>
|4.x >= 4.2     |5.x            |<<upgrade-standard,Standard upgrade>>
|5.0.0 pre GA   |5.x            |<<upgrade-standard-reindex,Standard upgrade & reindex>>
|5.x            |5.y            |<<upgrade-standard,Standard upgrade>> (where `y > x`)
|=======================================================================

[IMPORTANT]
===========================================
只要是从 Kibana 4.1 或 4.0 升级上来的，就需要进行重新索引。

即使你现在运行的 Kibana 版本为 4.2 或更高，如果之前是从 Kibana 4.0 或 4.1 升级过来的，你将需要进行一次 
<<upgrade-standard-reindex,Standard upgrade & reindex>> 来升级到 5.x。

这是因为 Elasticsearch 需要任何最初在 Elasticsearch 2.0 前创建的索引都需要重新索引，哪怕目前工作的版本是 Elasticsearch 2.x。

升级到 5.x 的过程中你只需要进行一次重新索引。
===========================================

NOTE: 由 Kibana 4.x 保存的查询、视图和指示板一般兼容 5.x。

include::upgrade/upgrade-standard.asciidoc[]

include::upgrade/upgrade-standard-reindex.asciidoc[]

include::upgrade/upgrade-new-install.asciidoc[]
